# Конвертация WebM в MOV (ProRes 4444)

Этот скрипт конвертирует все WebM файлы (с прозрачностью) в формат MOV ProRes 4444 для использования в After Effects.

## Требования

### 1. FFmpeg
Скрипт требует установленный FFmpeg.

**Установка FFmpeg (Windows):**

**Вариант A: Через пакетный менеджер (рекомендуется)**
```bash
# Chocolatey
choco install ffmpeg

# или Winget
winget install ffmpeg
```

**Вариант B: Вручную**
1. Скачайте FFmpeg: https://www.gyan.dev/ffmpeg/builds/
2. Выберите "ffmpeg-release-full.7z"
3. Распакуйте
4. Добавьте папку `bin` в PATH

**Проверка установки:**
```bash
ffmpeg -version
```

### 2. Node.js
Уже установлен (использовали для конвертации Lottie)

## Использование

### Быстрый старт (Windows):
Просто запустите:
```
webm-to-mov.bat
```

### Через командную строку:
```bash
node webm-to-mov.js
```

## Настройки

Откройте `webm-to-mov.js` и измените параметры в объекте `CONFIG`:

```javascript
const CONFIG = {
    inputDir: './output',           // Папка с WebM файлами
    outputDir: './output_mov',      // Папка для MOV файлов
    keepWebm: true,                 // Сохранить WebM файлы
    codec: 'prores_ks',             // ProRes кодек
    profile: '4444',                // ProRes 4444 (с альфа-каналом)
    pixelFormat: 'yuva444p10le',    // Формат пикселей с прозрачностью
};
```

## Форматы ProRes

Можете изменить профиль в настройках:

- `'4444'` - ProRes 4444 (с прозрачностью) ✓ **Рекомендуется**
- `'4444xq'` - ProRes 4444 XQ (максимальное качество, огромный размер)
- `'422hq'` - ProRes 422 HQ (без прозрачности)
- `'422'` - ProRes 422 (без прозрачности)

## Структура файлов

Скрипт сохраняет структуру папок:

```
output/                      (WebM файлы)
  5167939598143193218/
    Aetheris.lottie.webm
    
output_mov/                  (MOV файлы)
  5167939598143193218/
    Aetheris.lottie.mov
```

## Размеры файлов

**Примерные размеры:**
- WebM VP9: ~1.2 MB (3 секунды, 512x512)
- MOV ProRes 4444: ~25-40 MB (тот же файл)

**ProRes 4444 занимает в ~25-35 раз больше места**, но это профессиональный формат:
- ✓ Максимальное качество
- ✓ Полная прозрачность
- ✓ Быстрая работа в After Effects
- ✓ Нет артефактов сжатия

**Примерные размеры для 5606 файлов:**
- WebM: ~8 GB
- MOV ProRes 4444: **~200-280 GB**

## Время конвертации

- 1 файл: ~1-3 секунды
- 100 файлов: ~3-5 минут
- 5606 файлов: **~3-5 часов**

*Зависит от мощности компьютера*

## Использование в After Effects

1. Импортируйте MOV файлы в After Effects
2. Прозрачность будет работать автоматически
3. Файлы готовы к использованию без дополнительной обработки

## Оптимизация

### Если не хватает места на диске:

**Вариант 1:** Конвертируйте выборочно
```javascript
// В webm-to-mov.js измените:
inputDir: './output/5167939598143193218',  // Только одна папка
```

**Вариант 2:** Используйте ProRes 422 (без прозрачности, меньше размер)
```javascript
profile: '422hq',
pixelFormat: 'yuv422p10le',
```

**Вариант 3:** Конвертируйте по мере необходимости
- Храните WebM как исходники
- Конвертируйте в MOV только нужные файлы

## Отладка проблем

### "FFmpeg не установлен"
→ Установите FFmpeg (см. выше)

### "Не удается найти файлы"
→ Проверьте что папка `output` существует и содержит WebM файлы

### "Недостаточно места на диске"
→ Освободите ~300 GB или конвертируйте выборочно

### Медленная конвертация
→ Это нормально для ProRes 4444. Можно:
- Использовать более быстрый профиль (422hq)
- Запустить на ночь
- Использовать более мощный компьютер

## Дополнительные команды

### Конвертировать одну папку:
```javascript
// webm-to-mov.js
inputDir: './output/5167939598143193218',
```

### Изменить качество:
```javascript
profile: '422hq',  // Меньше размер, без прозрачности
```

### Удалить WebM после конвертации:
```javascript
keepWebm: false,
```
(Не рекомендуется - WebM хороший формат для хранения)

